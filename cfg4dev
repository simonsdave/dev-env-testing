if [ -f "$PWD/requirements.txt" ]; then
    # per guidelines in https://github.com/simonsdave/dev-env
    export DEV_ENV_DOCKER_IMAGE="simonsdave/dev-env-testing-xenial-dev-env:build"

    if [ -d "$PWD/env" ]; then
        source "$PWD/env/bin/activate"
    else
        virtualenv env
        source "$PWD/env/bin/activate"

        DEV_ENV_VERSION=$(cat "$PWD/dev_env/dev-env-version.txt")
        if [ "${DEV_ENV_VERSION:-}" == "latest" ]; then DEV_ENV_VERSION=master; fi
        curl -s -L https://raw.githubusercontent.com/simonsdave/dev-env/${DEV_ENV_VERSION}/bin/install-dev-env.sh | bash -s --
        unset DEV_ENV_VERSION

        "$PWD/dev_env/build-docker-image.sh" "$DEV_ENV_DOCKER_IMAGE"
    fi

    export PATH="$PWD/bin":$PATH
else
    echo "Must source this script from project's root directory" >&2
    return 1
fi
